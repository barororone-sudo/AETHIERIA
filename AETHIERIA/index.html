<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AETHERIA - Prototype</title>
    <link rel="stylesheet" href="style.css?v=9">
    <script type="importmap">
        {
            "imports": {
                "three": "./node_modules/three/build/three.module.js",
                "three/addons/": "./node_modules/three/examples/jsm/",
                "cannon-es": "./node_modules/cannon-es/dist/cannon-es.js"
            }
        }
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.3/howler.min.js"></script>
    <!-- âš¡ CRITICAL PERFORMANCE PATCH -->
    <script src="js/patches/performance-critical.js"></script>
    <!-- âš¡ CPU OPTIMIZATION -->
    <script src="js/patches/cpu-optimization.js"></script>
    <!-- Patch pour corriger la suppression de profil -->
    <script src="js/patches/profile-deletion-fix.js"></script>
    <!-- Patch pour systÃ¨me de quÃªtes -->
    <script src="js/patches/quest-event-system.js"></script>
    <!-- Patch pour CombatUI loot text -->
    <script src="js/patches/combatui-loot-fix.js"></script>
    <!-- Patch pour minimap et reveal -->
    <script src="js/patches/minimap-fix.js"></script>
    <!-- Patch pour mÃ©thodes manquantes (deleteSave, hasItem) -->
    <script src="js/patches/manager-methods.js"></script>
    <!-- Patch pour UI enhancements (Fullscreen + Tabs) -->
    <script src="js/patches/ui-enhancements.js"></script>
    <!-- Patch pour spawning de coffres et intÃ©gration quÃªtes -->
    <script src="js/patches/chest-spawning.js" type="module"></script>
    <!-- ðŸ”§ EMERGENCY FIX: Force enemy visibility -->
    <script src="js/patches/enemy-visibility-fix.js"></script>
    <!-- ðŸ’€ Death & Respawn System -->
    <script src="js/patches/death-system.js"></script>
    <!-- âš¡ Stamina UI System -->
    <script src="js/patches/stamina-ui.js"></script>
    <script src="js/patches/enemy-attack-fix.js"></script>
    <script src="js/patches/enemy-spawn-height-fix.js"></script>
    <script src="js/patches/quest-chest-spawn.js" type="module"></script>
</head>

<body>
    <div id="ui-container">
        <!-- LOADING SCREEN -->
        <div id="loading-screen">
            <div class="logo">AETHERIA</div>
            <div class="loading-bar-container">
                <div id="loading-bar-fill"></div>
            </div>
        </div>

        <!-- GAME HUD -->
        <div id="game-ui" style="display: none;">
            <!-- HEARTS -->
            <div id="hearts-container"></div>

            <!-- STAMINA RING (Injected via JS) -->

            <!-- CROSSHAIR -->
            <div id="crosshair">+</div>

            <!-- QUEST TRACKER -->
            <div id="quest-tracker">
                <div class="quest-title"></div>
                <div class="quest-objective"></div>
            </div>
        </div>

        <!-- MINIMAP -->
        <div id="minimap-container">
            <img id="map-layer-terrain" src="assets/world_map.png" style="z-index: 1;">
            <canvas id="map-layer-fog" style="z-index: 2; opacity: 0.95;"></canvas>
            <div id="map-layer-icons" style="z-index: 3;"></div>
        </div>

        <!-- PAUSE MENU -->
        <div id="pause-menu" style="display: none;">
            <div class="menu-container glass-panel">
                <h2>INVENTORY</h2>
                <div id="inventory-grid"></div>
            </div>
            <div class="stats-container glass-panel">
                <h2>STATS</h2>
                <div id="stats-content"></div>
            </div>
        </div>

        <!-- ERROR POPUP -->
        <div id="error-popup" style="display: none;">
            <div class="error-box">
                <h2>CRITICAL ERROR</h2>
                <div id="error-content"></div>
                <div class="error-buttons">
                    <button onclick="location.reload()">RELOAD</button>
                    <button onclick="document.getElementById('error-popup').style.display='none'">IGNORE</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module" src="./js/main.js?v=9"></script>
</body>

</html>